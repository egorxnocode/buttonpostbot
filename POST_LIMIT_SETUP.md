# üö´ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Å—Ç–æ–≤ - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –∫–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å **–º–∞–∫—Å–∏–º—É–º 3 –ø–æ—Å—Ç–∞** –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞.

## üîß –ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **–§–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏**: `migration_add_post_count.sql`
- **–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ**: `post_count INTEGER DEFAULT 0` –≤ —Ç–∞–±–ª–∏—Ü—É `button_users`
- **–ò–Ω–¥–µ–∫—Å**: –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Å—Ç–æ–≤

### 2. –ö–æ–¥ –±–æ—Ç–∞
- **database.py**: –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å—á–µ—Ç—á–∏–∫–æ–º
- **bot.py**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ—Å—Ç–∞
- **config.py**: –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö

## üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î
```sql
-- –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∫–æ–º–∞–Ω–¥—ã –∏–∑ —Ñ–∞–π–ª–∞ migration_add_post_count.sql
-- –≤ –≤–∞—à–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö Supabase

ALTER TABLE button_users 
ADD COLUMN post_count INTEGER DEFAULT 0 NOT NULL;

COMMENT ON COLUMN button_users.post_count IS '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (–º–∞–∫—Å. 3)';

CREATE INDEX idx_button_users_post_count ON button_users(post_count);

UPDATE button_users SET post_count = 0 WHERE post_count IS NULL;
```

### –®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
./stop.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
./start.sh
```

## ‚úÖ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ

### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ—Å—Ç–∞:
1. ‚úÖ **0-2 –ø–æ—Å—Ç–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ—Å—Ç—ã
2. üö´ **3 –ø–æ—Å—Ç–∞**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –ª–∏–º–∏—Ç–∞

### –°—á–µ—Ç—á–∏–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è:
- ‚úÖ **–¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏** –ø–æ—Å—Ç–∞ –≤ –∫–∞–Ω–∞–ª–µ
- ‚ùå **–ù–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è** –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ –∏–ª–∏ –æ—à–∏–±–∫–µ

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª–∏–º–∏—Ç–µ:
- üìä –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–º–∞–Ω–¥–µ `/start`
- üìä –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- üìä –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ/–æ—Å—Ç–∞–ª–æ—Å—å –ø–æ—Å—Ç–æ–≤

## üéØ –ü—Ä–∏–º–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π

### –ü—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –ª–∏–º–∏—Ç–∞:
```
üö´ –õ–∏–º–∏—Ç –ø–æ—Å—Ç–æ–≤ –∏—Å—á–µ—Ä–ø–∞–Ω

–í—ã —É–∂–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏ 3 –∏–∑ 3 –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤.

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –±–æ–ª—å—à–µ –ø–æ—Å—Ç–æ–≤ —Å–æ–∑–¥–∞—Ç—å –Ω–µ–ª—å–∑—è. 
–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É, –µ—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–π.
```

### –ü–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:
```
üéâ –ü–æ—Å—Ç —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –≤ –≤–∞—à–µ–º –∫–∞–Ω–∞–ª–µ!

üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ 2 –∏–∑ 3 –ø–æ—Å—Ç–æ–≤. –û—Å—Ç–∞–ª–æ—Å—å: 1
```

### –ü—Ä–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–º –ø–æ—Å—Ç–µ:
```
üéâ –ü–æ—Å—Ç —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –≤ –≤–∞—à–µ–º –∫–∞–Ω–∞–ª–µ!

üö´ –≠—Ç–æ –±—ã–ª –≤–∞—à –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø–æ—Å—Ç (3/3)
```

## üîß –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞

–ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –ª–∏–º–∏—Ç –ø–æ—Å—Ç–æ–≤ —Å 3 –Ω–∞ –¥—Ä—É–≥–æ–µ —á–∏—Å–ª–æ:

### –í database.py:
```python
# –°—Ç—Ä–æ–∫–∞ 692: –∏–∑–º–µ–Ω–∏—Ç—å max_posts
async def check_post_limit(self, telegram_id: int, max_posts: int = 5):  # –ë—ã–ª–æ: 3
```

### –í config.py:
```python
# –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Å –Ω–æ–≤—ã–º —á–∏—Å–ª–æ–º
'post_limit_reached': """
üö´ **–õ–∏–º–∏—Ç –ø–æ—Å—Ç–æ–≤ –∏—Å—á–µ—Ä–ø–∞–Ω**

–í—ã —É–∂–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏ {current_count} –∏–∑ {max_posts} –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤.
```

## üóÑÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞–º–∏

### –°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```sql
-- –°–±—Ä–æ—Å–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
UPDATE button_users 
SET post_count = 0 
WHERE telegram_id = 123456789;
```

### –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞:
```sql
-- –£–≤–µ–ª–∏—á–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Å—Ç—ã)
UPDATE button_users 
SET post_count = post_count - 1 
WHERE telegram_id = 123456789;
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
```sql
-- –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö —Å—á–µ—Ç—á–∏–∫–∏
SELECT email, telegram_id, post_count 
FROM button_users 
WHERE post_count > 0 
ORDER BY post_count DESC;
```

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **–ú–∏–≥—Ä–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞**: –ë–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –±–æ—Ç –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –°—á–µ—Ç—á–∏–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
3. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç —Å—á–µ—Ç—á–∏–∫ = 0
4. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ú–æ–∂–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å —Å—á–µ—Ç—á–∏–∫–∏ —á–µ—Ä–µ–∑ SQL-–∑–∞–ø—Ä–æ—Å—ã

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ 3 –ø–æ—Å—Ç–∞ –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
